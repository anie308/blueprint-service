 C:\Users\USER\Documents\code\blueprint-service> npm run build

> blueprint-xyz-backend@1.0.0 build
> tsc

src/controllers/index.ts:412:5 - error TS2322: Type 'string' is not assignable to type 'ObjectId'.

412     conversation.lastMessageId = message._id ;
        ~~~~~~~~~~~~~~~~~~~~~~~~~~

src/controllers/index.ts:457:5 - error TS2322: Type 'string' is not assignable to type 'ObjectId'.

457     conversation.lastMessageId = message._id;
        ~~~~~~~~~~~~~~~~~~~~~~~~~~

src/controllers/studioController.ts:241:32 - error TS2345: Argument of type 'string | undefined' is not assignable to parameter of type 'ObjectId'.
  Type 'undefined' is not assignable to type 'ObjectId'.

241   if (!studio.members.includes(userId)) {
                                   ~~~~~~

src/services/presenceService.ts:137:13 - error TS2375: Type '{ userId: string; username: string; status: UserStatus; lastSeen: Date | undefined; }' is not assignable to type 'PresenceData' with 'exactOptionalPropertyTypes: true'. Consider adding 'undefined' to the types of the target's properties.
  Types of property 'lastSeen' are incompatible.
    Type 'Date | undefined' is not assignable to type 'Date'.
      Type 'undefined' is not assignable to type 'Date'.

137       const presenceData: PresenceData = {
                ~~~~~~~~~~~~

src/socket/socketServer.ts:172:29 - error TS18049: 'conversation' is possibly 'null' or 'undefined'.

172             conversationId: conversation._id,
                                ~~~~~~~~~~~~

src/socket/socketServer.ts:179:11 - error TS18049: 'conversation' is possibly 'null' or 'undefined'.

179           conversation.lastMessageId = message._id;
              ~~~~~~~~~~~~

src/socket/socketServer.ts:179:11 - error TS2322: Type 'string' is not assignable to type 'ObjectId'.

179           conversation.lastMessageId = message._id;
              ~~~~~~~~~~~~~~~~~~~~~~~~~~

src/socket/socketServer.ts:180:17 - error TS18049: 'conversation' is possibly 'null' or 'undefined'.

180           await conversation.save();
                    ~~~~~~~~~~~~

src/socket/socketServer.ts:184:17 - error TS18049: 'conversation' is possibly 'null' or 'undefined'.

184           await conversation.populate(
                    ~~~~~~~~~~~~

src/socket/socketServer.ts:191:13 - error TS2322: Type '(Document<unknown, {}, IConversation, {}, {}> & IConversation & Required<{ _id: string; }> & { __v: number; }) | null | undefined' is not assignable to type 'IConversation'.
  Type 'undefined' is not assignable to type 'IConversation'.

191             conversation,
                ~~~~~~~~~~~~

  src/types/socket.ts:55:3
    55   conversation: IConversation;
         ~~~~~~~~~~~~
    The expected type comes from property 'conversation' which is declared here on type 'NewMessageData'

src/socket/socketServer.ts:196:42 - error TS18049: 'conversation' is possibly 'null' or 'undefined'.

196             .to(getRoomName.conversation(conversation._id.toString()))
                                             ~~~~~~~~~~~~

src/socket/socketServer.ts:200:39 - error TS18049: 'conversation' is possibly 'null' or 'undefined'.

200           for (const participantId of conversation.participants) {
                                          ~~~~~~~~~~~~

src/socket/socketServer.ts:228:66 - error TS2345: Argument of type 'string' is not assignable to parameter of type 'ObjectId'.

228         if (!conversation || !conversation.participants.includes(userId))
                                                                     ~~~~~~

src/socket/socketServer.ts:232:38 - error TS2345: Argument of type 'string' is not assignable to parameter of type 'ObjectId'.

232         if (!message.readBy.includes(userId)) {
                                         ~~~~~~

src/socket/socketServer.ts:233:31 - error TS2345: Argument of type 'string' is not assignable to parameter of type 'ObjectId'.

233           message.readBy.push(userId);
                                  ~~~~~~

src/socket/socketServer.ts:265:64 - error TS2345: Argument of type 'string' is not assignable to parameter of type 'ObjectId'.

265       if (!conversation || !conversation.participants.includes(userId)) return;
                                                                   ~~~~~~

src/socket/socketServer.ts:338:66 - error TS2345: Argument of type 'string' is not assignable to parameter of type 'ObjectId'.

338         if (!conversation || !conversation.participants.includes(userId))
                                                                     ~~~~~~

src/socket/socketServer.ts:378:47 - error TS2345: Argument of type 'string' is not assignable to parameter of type '"authenticated" | "authenticationError" | "newMessage" | "messageRead" | "messagingError" | "userStartedTyping" | "userStoppedTyping" | "userOnline" | "userOffline" | "userStatusChanged" | "conversationUpdated"'.

378     this.io.to(getRoomName.user(userId)).emit(event, data);
                                                  ~~~~~

src/socket/socketServer.ts:382:63 - error TS2345: Argument of type 'string' is not assignable to parameter of type '"authenticated" | "authenticationError" | "newMessage" | "messageRead" | "messagingError" | "userStartedTyping" | "userStoppedTyping" | "userOnline" | "userOffline" | "userStatusChanged" | "conversationUpdated"'.

382     this.io.to(getRoomName.conversation(conversationId)).emit(event, data);
                                                                  ~~~~~


Found 19 errors in 4 files.

Errors  Files
     2  src/controllers/index.ts:412
     1  src/controllers/studioController.ts:241
     1  src/services/presenceService.ts:137
    15  src/socket/socketServer.ts:172
PS C:\Users\USER\Documents\code\blueprint-service> 